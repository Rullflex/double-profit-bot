# üì¶ double-profit-bot

–ú–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram-–±–æ—Ç, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ TypeScript (Node.js), —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Google Sheets –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö/–≤–Ω–µ—à–Ω–∏—Ö –±–æ—Ç–æ–≤.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì¨ –ö–æ–º–∞–Ω–¥–∞ `/massmessage` ‚Äî –º–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —á–∞—Ç–∞–º
- üìä –ö–æ–º–∞–Ω–¥–∞ `/dailyreport` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á—ë—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞–º
- –ö–æ–º–∞–Ω–¥–∞ `/elama` ‚Äî –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –ø–æ HTML-–≤—ã–≥—Ä—É–∑–∫–∏ —Å —Å–µ—Ä–≤–∏—Å–∞ "–ï–ª–∞–º–∞"
- üìà –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ –î–î–° ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ
- ‚öôÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤ —á–∞—Ç–∞—Ö: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏
- üìó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Sheets

---

## üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
src/
‚îú‚îÄ‚îÄ bots/                  # –í—Ö–æ–¥–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–ª—è –±–æ—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îî‚îÄ‚îÄ external/
‚îú‚îÄ‚îÄ core/                  # appContext: DI –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º
‚îú‚îÄ‚îÄ services/              # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (logger, sheets)
‚îú‚îÄ‚îÄ usecases/              # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (massMessage, dailyReport, –∏ —Ç.–¥.)
‚îú‚îÄ‚îÄ handlers/              # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π Telegram
‚îú‚îÄ‚îÄ infrastructure/        # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∫–æ–¥ –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤ (—Ä–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ GoogleSheets)
‚îú‚îÄ‚îÄ shared/                # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —á–∞—Å—Ç–∏ –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–µ
‚îÇ   ‚îú‚îÄ‚îÄ utils/             # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ consts/
‚îÇ   ‚îî‚îÄ‚îÄ types/
```

---

## üîß –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **TypeScript**
- **Node.js (ESM)**
- **[grammY](https://grammy.dev/)** ‚Äî Telegram Bot API
- **Google Sheets API**
- **Vitest** ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **tsx** ‚Äî –∑–∞–ø—É—Å–∫ TS-—Ñ–∞–π–ª–æ–≤ –±–µ–∑ —Å–±–æ—Ä–∫–∏

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
npx vitest run
```

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–∫–æ–≤ (`vi.fn()`)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏ unit —Ç–µ—Å—Ç—ã
- –ü—Ä–∏–º–µ—Ä—ã –≤ `tests/`

---

## üõ° –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Google Sheets

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `credentials.json` —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
- –¢–∞–±–ª–∏—Ü—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞—Å—à–∞—Ä–µ–Ω—ã –Ω–∞ email –∞–∫–∫–∞—É–Ω—Ç–∞:

  ```text
  my-service-account@your-project.iam.gserviceaccount.com
  ```

---

## üìÇ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

`.env`:

```env
INTERNAL_BOT_TOKEN=...
EXTERNAL_BOT_TOKEN=...
```

---

## üß† –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–ß–µ—Ä–µ–∑ `AbortController`:

```ts
ctx: {
  signal: AbortSignal
  cancel: () => void 0
}
```

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∑–∞–¥–∞—á, graceful shutdown, –æ—Ç–º–µ–Ω—ã –∫–æ–º–∞–Ω–¥.

---

## üìå –°–æ–≥–ª–∞—à–µ–Ω–∏—è

- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –ø–æ —Å–ª–æ—è–º
- –ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞ –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–∞
- –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ: `camelCase.ts`, –≥–ª–∞–≥–æ–ª—ã –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
